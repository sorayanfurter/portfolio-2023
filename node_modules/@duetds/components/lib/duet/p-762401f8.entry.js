/*!
 * Built with Duet Design System
 */
import{h as o,F as t,r as e,c as s,H as i,g as c}from"./p-e2a64fc4.js";import{i as b}from"./p-4ebf1618.js";import{d}from"./p-0b3f675e.js";import{j as m,f as u,o as l,b as h,c as a}from"./p-f077c646.js";import{g as x,a as n,c as r,d as p}from"./p-076452be.js";import{p as g}from"./p-5a9d75e1.js";const v=({item:e,search:s="",selected:i})=>{const c=""!==s?new RegExp("("+s.split(" ").join("|")+")","gi"):void 0;return o(t,null,i&&o("duet-icon",{class:"option-icon",name:"messaging-checked",size:"xx-small",margin:"none"}),c?o("span",{class:"option-container","aria-hidden":"true"},o("span",{innerHTML:e.name.replace(c,'<span class="highlight">$&</span>')})):e.name,e.tags&&o("span",{class:"option-tags"},e.tags.join(", ")))},f=({item:t,active:e,total:s,selected:i,label:c,clickHandler:b=(o=>{o.preventDefault()}),keyHandler:d=(o=>{o.preventDefault()}),search:m})=>o("li",{class:{"list-item":!0,option:!0,active:e,selected:i},id:e?"active_item":"","data-index":t.id,"aria-selected":e?"true":void 0,"aria-current":i?"true":void 0,role:"option","aria-label":c||`${t.name}, (${t.id+1} of ${s})`},o("a",{tabindex:"-1",onClick:o=>b(o),onKeyUp:o=>d(o),class:"option-link","aria-label":c||`${t.name}, (${t.id+1} of ${s})`,"aria-hidden":"true"},o(v,{item:t,search:m,selected:i}))),k=class{constructor(o){e(this,o),this.duetChange=s(this,"duetChange",3),this.resizeObserver=new ResizeObserver(d((o=>{var t,e;if(1===(null==o?void 0:o.length)){const s=null===(e=null===(t=o[0])||void 0===t?void 0:t.target)||void 0===e?void 0:e.getBoundingClientRect().width;this.listContainer.style.width=`${s+1}px`}}),100)),this.processedItems=null,this.inputWidth=0,this.inputValue="",this.selectionMsg="",this.listOpen=!1,this.selectedItems=new Set,this.activeItem=void 0,this.language=x(),this.accessibleLabelDefaults={en:{heading:"Select:",item:"{name}, ({current} of {total})",itemFiltered:"{name}, ({current} of {total}, {hiddenItems} filtered)"},fi:{heading:"Valitse:",item:"{name}, ({current}/{total})",itemFiltered:"{name}, ({current}/{total}, {hiddenItems} suodatettu)"},sv:{heading:"VÃ¤lj:",item:"{name}, ({current} av {total})",itemFiltered:"{name}, ({current} av {total}, {hiddenItems} filtrerade)"}},this.accessibleLabels=n(g(this.accessibleLabelDefaults),x()),this.theme="",this.force=!1,this.items=void 0,this.formatter=o=>o&&o.name?o.name:"",this.value=void 0,this.minCharacters=1,this.openListOnClick=!1,this.filterType="startsWith"}activeItemHandler(o){this.input.accessibleActiveDescendant=this.listOpen&&(o||0===o)?"active_item":""}watchLanguageStateHandler(o,t){o!==t&&this.accessibleLabels===n(g(this.accessibleLabelDefaults),t)&&(this.accessibleLabels=n(g(this.accessibleLabelDefaults),o))}handleDocumentClick(o){o.composedPath().every((o=>o!==this.element))&&(this.updateInputText(!0),this.listOpen=!1)}async formatItem(o){return this.formatter(o)}async processItems(){this.items=this.processedItems=g(this.items),await this.updateInputText()}async processValue(){if(this.value){const o=this.items.find((o=>o.value===this.value));this.updateSelectedItems(o.id)}}componentWillLoad(){b(this)}connectedCallback(){this.items=this.processedItems=g(this.items),this.input=this.element.querySelector("duet-input"),this.input.addEventListener("duetChange",this.updateInputValue.bind(this)),this.input.addEventListener("click",(()=>{this.listOpen=this.openListOnClick?!this.listOpen:this.inputValue.length>=this.minCharacters})),this.element.addEventListener("keydown",this.handleInputKeyDownEvent.bind(this)),r(this),this.input.accessibleAutocomplete="list",this.input.accessibleControls="duet-combobox-list-element"}disconnectedCallback(){this.input.removeEventListener("duetChange",this.updateInputValue.bind(this)),this.input.removeEventListener("click",(()=>this.listOpen=!!this.inputValue.length)),this.element.removeEventListener("keydown",this.handleInputKeyDownEvent.bind(this)),this.listElement.removeEventListener("click",(o=>{o.stopPropagation()})),this.resizeObserver.disconnect(),p(this)}componentDidLoad(){this.resizeObserver.observe(this.input),this.listElement.addEventListener("click",(o=>{o.stopPropagation()})),this.processValue()}onListClick(o,t){return o.preventDefault(),this.updateSelectedItems(t.id,!0),this.listOpen=!1,this.listOpen}shouldListBeFiltered(){if(this.selectedItems.size&&this.input.value===this.inputValue){const o=this.items.filter((o=>this.selectedItems.has(o.id)));return!(this.formatter(o).toLowerCase()===this.input.value.toLowerCase())}return!0}returnFilteredOrNonFiltered(){return this.processedItems?this.shouldListBeFiltered()?this.getFilteredItems():this.sortFilteredItems(this.processedItems):[]}async updateSelectedItems(o,t){if(this.selectedItems.clear(),this.selectedItems&&(this.selectedItems.has(o)?this.selectedItems.delete(o):this.selectedItems.add(o)),t){const o=0===this.selectedItems.size?[]:this.items.filter((o=>this.selectedItems.has(o.id)));this.duetChange.emit({value:o[0].value,item:o[0],component:"duet-combobox"})}await this.updateInputText()}async updateInputText(o=!1){const t=0===this.selectedItems.size?[]:this.items.filter((o=>this.selectedItems.has(o.id)));0===t.length&&this.selectedItems.size>0&&(this.selectedItems.clear(),this.input.value="",this.value=void 0,this.activeItem=void 0),1===this.selectedItems.size&&(this.input.value="",this.input.value=await this.formatItem(t[0]),this.input.scrollLeft=this.input.scrollWidth,this.activeItem=void 0,this.value=t[0].value),o&&0===this.selectedItems.size&&(this.force&&(this.inputValue="",this.input.value=""),this.activeItem=void 0),this.listOpen=!1}updateInputValue(o){var t;this.inputValue=o.detail.value,this.listOpen=String(this.inputValue).length>=this.minCharacters&&(null===(t=this.getFilteredItems())||void 0===t?void 0:t.length)>0}handleInputKeyDownEvent(o){if(this.input.accessibleActiveDescendant=void 0,m(o))return o.preventDefault(),this.selectActiveItem(),this.updateInputText(!1),void(this.listOpen=!1);if(u(o)||l(o))return this.updateInputText(!0),void(this.listOpen=!1);let t=this.activeItem;if(h(o)?(o.preventDefault(),t=this.activeItem-1):a(o)&&(o.preventDefault(),t=this.listOpen?this.activeItem+1:this.activeItem,this.listOpen=!0),a(o)||h(o)){const o=this.shouldListBeFiltered()?this.getFilteredItems():this.processedItems;(t<0||!t)&&(t=0),t>=o.length&&(t=o.length-1),this.input.accessibleActiveDescendant="active_item",this.activeItem=t,this.scrollToActive()}this.announceActive()}selectActiveItem(){if(void 0===this.activeItem)return;const o=this.returnFilteredOrNonFiltered();this.updateSelectedItems(o[this.activeItem].id,!0)}announceActive(o){o||(o=this.returnFilteredOrNonFiltered()),void 0!==this.activeItem&&-1!==this.activeItem&&(this.selectionMsg=structuredClone(this.formatLabel(o[this.activeItem],o.length,this.items.length)))}scrollToActive(){const o=this.listElement.querySelector(".active");o&&o.scrollIntoView({behavior:"smooth",block:"center"})}formatLabel(o,t,e){return o&&void 0!==e?(t===e?this.accessibleLabels.item:this.accessibleLabels.itemFiltered).replace("{name}",String(o.name)).replace("{current}",String(this.activeItem+1)).replace("{total}",String(t)).replace("{hiddenItems}",String(e-t)):""}getFilteredItems(){const o=this.processedItems.filter((o=>{var t,e,s,i;return(null===(t=String(o.value))||void 0===t?void 0:t.toLowerCase()[this.filterType](null===(e=this.inputValue)||void 0===e?void 0:e.toLowerCase()))||(null===(s=String(o.name))||void 0===s?void 0:s.toLowerCase()[this.filterType](null===(i=this.inputValue)||void 0===i?void 0:i.toLowerCase()))||this.selectedItems.has(o.id)}));return this.sortFilteredItems(o)}sortFilteredItems(o){return o.length>0&&o.filter((o=>this.selectedItems.has(o.id))).forEach((t=>{const e=o.indexOf(t);o.splice(e,1),o.unshift(t)})),o}render(){const t=this.returnFilteredOrNonFiltered();return o(i,{role:"combobox","aria-expanded":this.listOpen?"true":"false","aria-owns":"duet-combobox-list-element","aria-haspopup":"listbox",class:{"duet-combobox":!0,[`duet-theme-${this.theme}`]:!0}},o("slot",null),o("div",{role:"list",class:{"duet-combobox-list":!0,open:this.listOpen},ref:o=>this.listContainer=o},o("ul",{class:{"duet-combobox-listbox-open":this.listOpen,"duet-combobox-listbox":!0},role:"listbox",ref:o=>this.listElement=o,id:"duet-combobox-list-element"},t.map(((e,s)=>o(f,{item:e,active:s===this.activeItem,selected:this.selectedItems.has(e.id),search:this.inputValue,total:t.length,clickHandler:o=>this.onListClick(o,e),label:this.formatLabel(e,t.length,this.items.length)}))))))}get element(){return c(this)}static get watchers(){return{activeItem:["activeItemHandler"],language:["watchLanguageStateHandler"],items:["processItems"],value:["processValue"]}}};k.style='.sc-duet-combobox-h{box-sizing:border-box;padding:0;margin:0;background:transparent;border:0;-moz-appearance:none;-webkit-appearance:none;appearance:none;position:relative;display:inline-block;width:100%;font-family:"localtapiola-sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";color:rgb(0, 41, 77)}.sc-duet-combobox-h a.sc-duet-combobox{color:rgb(0, 41, 77);transition:none}.duet-theme-turva.sc-duet-combobox-h{font-family:"turva-sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";color:rgb(23, 28, 58)}.duet-theme-turva.sc-duet-combobox-h a.sc-duet-combobox{color:rgb(23, 28, 58)}.duet-theme-turva.sc-duet-combobox-h .duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.option.sc-duet-combobox .option-tags.sc-duet-combobox{color:rgb(116, 116, 117)}.duet-theme-turva.sc-duet-combobox-h .duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.option.selected.sc-duet-combobox{background:rgb(244, 207, 214)}.duet-theme-turva.sc-duet-combobox-h .duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.active.sc-duet-combobox,.duet-theme-turva.sc-duet-combobox-h .duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.sc-duet-combobox:focus,.duet-theme-turva.sc-duet-combobox-h .duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.sc-duet-combobox:hover{color:rgb(255, 255, 255);background:rgb(198, 12, 48)}.duet-theme-turva.sc-duet-combobox-h .duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.active.sc-duet-combobox .option-tags.sc-duet-combobox,.duet-theme-turva.sc-duet-combobox-h .duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.sc-duet-combobox:focus .option-tags.sc-duet-combobox,.duet-theme-turva.sc-duet-combobox-h .duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.sc-duet-combobox:hover .option-tags.sc-duet-combobox{color:rgb(255, 255, 255)}.duet-theme-turva.sc-duet-combobox-h .duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.active.sc-duet-combobox a.sc-duet-combobox,.duet-theme-turva.sc-duet-combobox-h .duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.sc-duet-combobox:focus a.sc-duet-combobox,.duet-theme-turva.sc-duet-combobox-h .duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.sc-duet-combobox:hover a.sc-duet-combobox{color:rgb(255, 255, 255)}.duet-combobox-list.sc-duet-combobox{position:absolute;top:calc(100% - 12px);height:0;overflow:hidden;background:rgb(255, 255, 255);border-radius:0 4px;box-shadow:0 2px 10px 0 rgba(0, 41, 77, 0.1);opacity:0}.duet-combobox-list.open.sc-duet-combobox{z-index:700;display:block;height:auto;opacity:1}.duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox{max-height:200px;padding:0.75rem 0;margin:0;overflow-y:scroll;font-weight:600;list-style:none;cursor:pointer;scroll-behavior:smooth}.duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.sc-duet-combobox{padding:4px 0}.duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.sc-duet-combobox:not(.selected){padding-left:16px}.duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.sc-duet-combobox:not(.selected) .highlight.sc-duet-combobox{text-decoration:underline}.duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.option.sc-duet-combobox .option-link.sc-duet-combobox{display:block;width:100%}.duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.option.sc-duet-combobox .option-tags.sc-duet-combobox{float:right;padding-right:0.875rem;font-weight:400;color:rgb(144, 149, 153)}.duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.option-link.sc-duet-combobox{display:block;width:100%}.duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.selected.sc-duet-combobox{padding-left:0;background:rgb(205, 229, 241)}.duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.selected.option.sc-duet-combobox .option-icon.sc-duet-combobox{padding:0 8px 0 8px}.duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.selected.option.sc-duet-combobox .option-tags.sc-duet-combobox{color:rgb(144, 149, 153)}.duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.active.sc-duet-combobox,.duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.sc-duet-combobox:focus,.duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.sc-duet-combobox:hover{color:rgb(255, 255, 255);background:rgb(0, 119, 179)}.duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.active.sc-duet-combobox .option-tags.sc-duet-combobox,.duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.sc-duet-combobox:focus .option-tags.sc-duet-combobox,.duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.sc-duet-combobox:hover .option-tags.sc-duet-combobox{color:rgb(255, 255, 255)}.duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.active.sc-duet-combobox a.sc-duet-combobox,.duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.sc-duet-combobox:focus a.sc-duet-combobox,.duet-combobox-list.sc-duet-combobox .duet-combobox-listbox.sc-duet-combobox .list-item.sc-duet-combobox:hover a.sc-duet-combobox{color:rgb(255, 255, 255)}';export{k as duet_combobox}